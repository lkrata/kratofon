<!DOCTYPE html><!--odstavce-bez-pomlcky-->
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <title>Kratophon Web v1.9</title>
   <meta name="description" content="Kratophon: Okamžitý přepis řeči zdarma. Přepisuje mluvenou češtinu přímo na obrazovku. Žádná instalace ani registrace – stačí jeden klik." />
   <style>
        body { background-color: black; color: white; font-family: sans-serif; margin: 0; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        #controls { background: #1a1a1a; padding: 5px; display: flex; flex-wrap: wrap; gap: 8px; align-items: center; border-bottom: 1px solid #333; z-index: 100; }
        .group { display: flex; gap: 4px; align-items: center; border-right: 1px solid #444; padding-right: 8px; }
        button { padding: 4px 8px; cursor: pointer; background: #333; color: white; border: 1px solid #555; border-radius: 4px; font-weight: bold; font-size: 13px; }
        #btn-toggle { min-width: 70px; }
        .running { background: #2d5a27; }
        .stopped { background: #b30000; }
        #output-container { flex-grow: 1; padding: 10px 15px; overflow-y: auto; scroll-behavior: smooth; }
        #output { font-size: 32px; line-height: 1.1; overflow-wrap: break-word; padding-bottom: 30vh; }
        .interim { color: inherit; opacity: 1.0; }
        #help { background: #b30000; color: white; padding: 5px; text-align: center; display: none; font-size: 14px; }
    </style>
</head>
<body>
    <div id="help">Povolte mikrofon v adresním řádku prohlížeče!</div>
    <div id="controls">
        <button id="btn-toggle" onclick="toggle()" class="stopped">START</button>
        <div class="group">
            <button onclick="sz(4)">Písmo +</button>
            <button onclick="sz(-4)">Písmo -</button>
        </div>
        <div class="group">
            <button onclick="bg('black')" style="background:black; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="bg('white')" style="background:white; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="bg('navy')" style="background:navy; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="bg('darkgreen')" style="background:darkgreen; width:20px; height:20px; border:1px solid #ffcc00"></button>
        </div>
        <div class="group">
            <button onclick="fg('white')" style="background:white; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="fg('silver')" style="background:silver; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="fg('yellow')" style="background:yellow; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="fg('navy')" style="background:navy; width:20px; height:20px; border:1px solid #ffcc00"></button>
            <button onclick="fg('black')" style="background:black; width:20px; height:20px; border:1px solid #ffcc00"></button>
        </div>
        <button onclick="cp()">Kopírovat</button>
        <button onclick="cl()" style="background:#600">Smazat</button>
    </div>
    <div id="output-container"><div id="output" style="height: 50%">Klikněte na START...</div></div>
    <script>
    const out = document.getElementById('output');
    const btn = document.getElementById('btn-toggle');
    const cnt = document.getElementById('output-container');
    let run = false, txt = '';
    
    // --- DOPLNĚNÉ PROMĚNNÉ PRO PAUZU ---
    let lastResultTime = Date.now(); 
    const pauseLimit = 2000; 

    const rec = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
    rec.lang = 'cs-CZ'; rec.interimResults = true; rec.continuous = true;

    function toggle() {
        if (run) { rec.stop(); run = false; btn.innerText = "START"; btn.className = "stopped"; }
        else { 
            try { 
                rec.start(); 
                run = true; 
                btn.innerText = "STOP"; 
                btn.className = "running"; 
                if(out.innerText.includes("Klikněte")) out.innerHTML = ""; 
            } catch(e) {} 
        }
    }

    rec.onresult = (e) => {
            let interim = '';
            let now = Date.now();
            
            // --- DETEKCE PAUZY PRO NOVÝ ODSTAVEC (bez pomlčky) ---
            if (now - lastResultTime > pauseLimit && txt !== '') {
                txt += '<br><br>'; // Jen prázdné řádky pro oddělení bloků
                lastResultTime = now; 
            }
            
            if (e.results.length > 0) lastResultTime = now;

            for (let i = e.resultIndex; i < e.results.length; ++i) {
                if (e.results[i].isFinal) {
                    txt += e.results[i][0].transcript + ' ';
                } else {
                    interim += e.results[i][0].transcript;
                }
            }
            
            out.innerHTML = txt + '<span class="interim">' + interim + '</span>';
            cnt.scrollTop = cnt.scrollHeight;
        };

    rec.onend = () => { if (run) try { rec.start(); } catch(e) {} };
    rec.onerror = (e) => { if (e.error === 'not-allowed') document.getElementById('help').style.display = "block"; };
    
    function sz(d) { let s = parseInt(window.getComputedStyle(out).fontSize); out.style.fontSize = (s + d) + 'px'; }
    function bg(c) { document.body.style.backgroundColor = c; }
    function fg(c) { out.style.color = c; }
    function cl() { txt = ''; out.innerHTML = ''; }
    function cp() { 
        navigator.clipboard.writeText(out.innerText); 
        let t = btn.innerText; 
        btn.innerText = "OK!"; 
        setTimeout(() => btn.innerText = t, 1000); 
    }
</script>
    </body>
</html>




